<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dad's Smart Health Tracker</title>
    <style>
        body { font-family: 'Poppins', sans-serif; background: #f4f7f6; margin: 0; padding: 15px; text-align: center; }
        .container { max-width: 400px; margin: auto; background: white; padding: 25px; border-radius: 25px; box-shadow: 0 10px 30px rgba(0,0,0,0.08); }
        h1 { color: #2c3e50; margin-bottom: 5px; font-size: 24px; }
        .date-display { color: #e74c3c; font-weight: bold; margin-bottom: 20px; font-size: 1.1rem; }
        
        .pill-card { 
            background: #fff; border: 1px solid #eee; border-radius: 18px; 
            padding: 15px; margin-bottom: 12px; display: flex; 
            justify-content: space-between; align-items: center;
        }
        .pill-info { text-align: left; }
        .pill-time { font-weight: 800; color: #3498db; display: block; font-size: 0.9rem; }
        .pill-name { font-size: 1rem; color: #2d3436; font-weight: 500; }

        .check-btn { 
            width: 60px; height: 60px; border-radius: 50%; border: none; 
            background: #dfe6e9; cursor: pointer; font-size: 24px; color: white;
            transition: all 0.4s ease; display: flex; align-items: center; justify-content: center;
        }

        .taken { background: #2ecc71 !important; transform: scale(1.05); }
        .missed { background: #e74c3c !important; }
        .waiting { background: #f1c40f !important; color: #fff; }
    </style>
</head>
<body>

<div class="container">
    <h1>Tablet Tracker</h1>
    <div id="currentDate" class="date-display"></div>

    <div id="tracker-list">
        <div class="pill-card">
            <div class="pill-info"><span class="pill-time">7:00 AM - 8:00 AM</span><span class="pill-name">1 Sugar Tablet</span></div>
            <button class="check-btn" id="btn-1" onclick="markTaken(1)"></button>
        </div>
        <div class="pill-card">
            <div class="pill-info"><span class="pill-time">9:00 AM - 10:00 AM</span><span class="pill-name">1 Sugar + 1 BP</span></div>
            <button class="check-btn" id="btn-2" onclick="markTaken(2)"></button>
        </div>
        <div class="pill-card">
            <div class="pill-info"><span class="pill-time">12:30 PM - 1:30 PM</span><span class="pill-name">2 Cancer Tablets</span></div>
            <button class="check-btn" id="btn-3" onclick="markTaken(3)"></button>
        </div>
        <div class="pill-card">
            <div class="pill-info"><span class="pill-time">6:00 PM - 7:00 PM</span><span class="pill-name">1 Sugar Tablet</span></div>
            <button class="check-btn" id="btn-4" onclick="markTaken(4)"></button>
        </div>
        <div class="pill-card">
            <div class="pill-info"><span class="pill-time">8:30 PM - 9:30 PM</span><span class="pill-name">2 Cancer Tablets</span></div>
            <button class="check-btn" id="btn-5" onclick="markTaken(5)"></button>
        </div>
    </div>
</div>

<script>
    const schedule = [
        { id: 1, h: 7, m: 0 },
        { id: 2, h: 9, m: 0 },
        { id: 3, h: 12, m: 30 },
        { id: 4, h: 18, m: 0 },
        { id: 5, h: 20, m: 30 }
    ];

    function refreshTracker() {
        const now = new Date();
        const dateKey = now.getFullYear() + "-" + (now.getMonth() + 1) + "-" + now.getDate();
        
        // Update the visual date at top
        const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
        document.getElementById('currentDate').innerText = now.toLocaleDateString(undefined, options);

        schedule.forEach(item => {
            const btn = document.getElementById(`btn-${item.id}`);
            const start = new Date();
            start.setHours(item.h, item.m, 0);
            
            const end = new Date(start);
            end.setHours(start.getHours() + 1); // 1-hour validity window

            const storedStatus = localStorage.getItem(`pill_${item.id}_${dateKey}`);

            if (storedStatus === 'done') {
                btn.className = 'check-btn taken';
                btn.innerHTML = '✔';
                btn.disabled = true;
            } else if (now > end) {
                btn.className = 'check-btn missed';
                btn.innerHTML = '✘';
                btn.disabled = true;
            } else if (now >= start && now <= end) {
                btn.className = 'check-btn'; // Ready to be clicked
                btn.innerHTML = 'TAP';
                btn.disabled = false;
            } else {
                btn.className = 'check-btn waiting';
                btn.innerHTML = '⏳';
                btn.disabled = true;
            }
        });
    }

    function markTaken(id) {
        const now = new Date();
        const dateKey = now.getFullYear() + "-" + (now.getMonth() + 1) + "-" + now.getDate();
        localStorage.setItem(`pill_${id}_${dateKey}`, 'done');
        refreshTracker();
    }

    // Run every second to keep it real-time
    setInterval(refreshTracker, 1000);
    window.onload = refreshTracker;
</script>

</body>
</html>
